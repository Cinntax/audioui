SourceCollection = function()
{
	PASources = new Meteor.Collection("Sources");

	SourceCollection.prototype.find = function(selector,options)
	{
		return PASources.find(selector,options);
	}
	
	if(Meteor.isServer)
	{	
		SourceCollection.prototype.RefreshPASources = function()
		{
			PASources.remove({});
			var exec = Npm.require('child_process').exec;
			var Fiber = Npm.require('fibers')
			
				exec('pactl list short sources', function (error, stdout, stderr) {
					Fiber(function (stdout)
					{
						console.log("sourceoutput" + stdout.toString());
						sourceHeaders = stdout.toString().split('\n');
		    		for(i=0;i<sourceHeaders.length;i++)
						{
							var newSource = new Source();
      				sourceDetail = sourceHeaders[i].split('\t');
						
        			newSource.index = sourceDetail[0]; //Index Number
        			newSource.name = sourceDetail[1]; //Name
							newSource.type = sourceDetail[2]; //Type of Source
							PASources.insert(newSource);	
						}
				}).run(stdout)});
		}
	
	this.RefreshPASources();
	}
}
